# ๐ ุฎุทุฉ ุงุฎุชุจุงุฑ ุฑุญูุฉ ุงูุชูุนูู ุนุจุฑ WhatsApp

## ๐ฏ **ุงููุฏู**
ุงุฎุชุจุงุฑ ุงูุฑุญูุฉ ุงููุงููุฉ ูู ุตูุญุฉ checkout ุฅูู ุชูุนูู ุงูุญุณุงุจ ุนุจุฑ WhatsApp ูุงูุนูุฏุฉ ุฅูู checkout ูุน ุชุญุฏูุซ ุงูุญุงูุฉ.

---

## ๐ **ุงูุฑุญูุฉ ุงููุงููุฉ - ุฎุทูุฉ ุจุฎุทูุฉ**

### **ุงูุฎุทูุฉ 1: ููุทุฉ ุงูุจุฏุงูุฉ - Checkout Page**
```
URL: /checkout
ุงูุญุงูุฉ: user.isOtp = false
```

**ูุง ูุฌุจ ุงุฎุชุจุงุฑู:**
- [ ] ุนุฑุถ ุฑุงุจุท "ุบูุฑ ููุนู - ุงููุฑ ููุชูุนูู" ูู UserInfoCard
- [ ] ุงูุฑุงุจุท ููุฌู ุฅูู `/auth/verify?redirect=/checkout`
- [ ] ุนุฑุถ ุฑุณุงูุฉ ุชุญุฐูุฑ ุฃู ุงูุญุณุงุจ ุบูุฑ ููุนู

### **ุงูุฎุทูุฉ 2: ุตูุญุฉ ุงูุชูุนูู - Verify Page**
```
URL: /auth/verify?redirect=/checkout
ุงูุญุงูุฉ: ุนุฑุถ ูููุฐุฌ ุฅุฑุณุงู OTP
```

**ูุง ูุฌุจ ุงุฎุชุจุงุฑู:**
- [ ] ุนุฑุถ ุฑูู ุงููุงุชู ุจุดูู ุตุญูุญ
- [ ] ุฒุฑ "ุฅุฑุณุงู ุงูุฑูุฒ ุนุจุฑ ูุงุชุณุงุจ" ูุนูู
- [ ] ูู dev mode: ุนุฑุถ OTP ูู ุตูุฏูู ุฃุตูุฑ
- [ ] ุฑุณุงุฆู ุงููุฌุงุญ/ุงูุฎุทุฃ ุชุธูุฑ ุจุดูู ุตุญูุญ

### **ุงูุฎุทูุฉ 3: ุฅุฑุณุงู OTP**
```
Action: handleSendOTP()
API: otpViaWhatsApp(phoneNumber)
```

**ูุง ูุฌุจ ุงุฎุชุจุงุฑู:**
- [ ] ุงุณุชุฏุนุงุก `otpViaWhatsApp` ุจูุฌุงุญ
- [ ] ุนุฑุถ ุฑุณุงูุฉ "ุชู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู ุนุจุฑ WhatsApp ุจูุฌุงุญ"
- [ ] ูู dev mode: ุนุฑุถ OTP ููุงุฎุชุจุงุฑ
- [ ] ุชูุนูู ูููุฐุฌ ุฅุฏุฎุงู OTP
- [ ] ุจุฏุก ุงูุนุฏ ุงูุชูุงุฒูู (60 ุซุงููุฉ)

### **ุงูุฎุทูุฉ 4: ุฅุฏุฎุงู OTP**
```
Action: handleSubmit()
API: verifyTheUser(phoneNumber, code)
```

**ูุง ูุฌุจ ุงุฎุชุจุงุฑู:**
- [ ] ุงูุชุญูู ูู ุตุญุฉ OTP (4 ุฃุฑูุงู)
- [ ] ุงุณุชุฏุนุงุก `verifyTheUser` ุจูุฌุงุญ
- [ ] ุชุญุฏูุซ `user.isOtp = true` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ SweetAlert
- [ ] ุงูุนูุฏุฉ ุฅูู `/checkout`

### **ุงูุฎุทูุฉ 5: ุงูุนูุฏุฉ ุฅูู Checkout**
```
URL: /checkout
ุงูุญุงูุฉ: user.isOtp = true
```

**ูุง ูุฌุจ ุงุฎุชุจุงุฑู:**
- [ ] ุชุญุฏูุซ ุญุงูุฉ ุงูุชูุนูู ูู UserInfoCard
- [ ] ุฅุฎูุงุก ุฑุงุจุท ุงูุชูุนูู
- [ ] ุนุฑุถ "โ ููุนู" ุจุฏูุงู ูู "ุบูุฑ ููุนู"
- [ ] ุฅููุงููุฉ ุฅููุงู ุนูููุฉ ุงูุดุฑุงุก

---

## ๐งช **ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ**

### **ุงูุณููุงุฑูู 1: ุฑุญูุฉ ูุงุฌุญุฉ ูุงููุฉ**
1. **Setup**: ุชุณุฌูู ุฏุฎูู ุจุญุณุงุจ ุบูุฑ ููุนู
2. **Action**: ุงูุฐูุงุจ ุฅูู checkout
3. **Action**: ุงูููุฑ ุนูู "ุชูุนูู ุงูุญุณุงุจ"
4. **Action**: ุฅุฑุณุงู OTP
5. **Action**: ุฅุฏุฎุงู OTP ุงูุตุญูุญ
6. **Expected**: ุงูุนูุฏุฉ ุฅูู checkout ูุน ุชูุนูู ุงูุญุณุงุจ

### **ุงูุณููุงุฑูู 2: OTP ุฎุงุทุฆ**
1. **Setup**: ุชุณุฌูู ุฏุฎูู ุจุญุณุงุจ ุบูุฑ ููุนู
2. **Action**: ุงูุฐูุงุจ ุฅูู ุตูุญุฉ ุงูุชูุนูู
3. **Action**: ุฅุฑุณุงู OTP
4. **Action**: ุฅุฏุฎุงู OTP ุฎุงุทุฆ
5. **Expected**: ุฑุณุงูุฉ ุฎุทุฃ "ุฑูุฒ ุงูุชุญูู ุบูุฑ ุตุญูุญ"

### **ุงูุณููุงุฑูู 3: ุฅุนุงุฏุฉ ุฅุฑุณุงู OTP**
1. **Setup**: ูู ุตูุญุฉ ุงูุชูุนูู ูุน OTP ูุฑุณู
2. **Action**: ุงูููุฑ ุนูู "ุฅุนุงุฏุฉ ุฅุฑุณุงู ุงูุฑูุฒ"
3. **Expected**: ุฅุฑุณุงู OTP ุฌุฏูุฏ ูุน ุชุญุฏูุซ ุงูุนุฏ ุงูุชูุงุฒูู

### **ุงูุณููุงุฑูู 4: Rate Limiting**
1. **Setup**: ูุญุงููุฉ ุฅุฑุณุงู OTP ุนุฏุฉ ูุฑุงุช
2. **Action**: ุฅุฑุณุงู OTP ุฃูุซุฑ ูู 5 ูุฑุงุช ูู ุณุงุนุฉ
3. **Expected**: ุฑุณุงูุฉ "ุชู ุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู ูุทูุจุงุช ุงูุฑูุฒ"

---

## ๐ง **ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ**

### **1. Dev Mode Features**
```typescript
// ุนุฑุถ OTP ูู ูุถุน ุงูุชุทููุฑ
{process.env.NODE_ENV === 'development' && isOTPSent && otpFromBackEnd && (
  <div className="mt-2 text-xs text-muted-foreground p-2 bg-yellow-50 border border-yellow-200 rounded">
    <span>ุฑูุฒ ุงูุงุฎุชุจุงุฑ (Dev): </span>
    <span className="font-mono font-bold text-yellow-700">{otpFromBackEnd}</span>
  </div>
)}
```

### **2. Console Logging**
```typescript
// ุฅุถุงูุฉ logs ููุงุฎุชุจุงุฑ
console.log('Sending OTP to:', userPhone);
console.log('OTP Result:', result);
console.log('Verification Result:', result);
```

### **3. Database Check**
```sql
-- ุงูุชุญูู ูู ุชุญุฏูุซ ุงูุญุงูุฉ
SELECT id, phone, isOtp, otpCode, isActive 
FROM User 
WHERE phone = 'your_test_phone';
```

---

## ๐จ **ููุงุท ุงููุดู ุงููุญุชููุฉ**

### **1. WhatsApp API Issues**
- **ุงููุดููุฉ**: ูุดู ูู ุฅุฑุณุงู WhatsApp
- **ุงูุญู**: ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ
- **ุงูุงุฎุชุจุงุฑ**: ูุทุน ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช

### **2. Database Issues**
- **ุงููุดููุฉ**: ูุดู ูู ุชุญุฏูุซ `isOtp`
- **ุงูุญู**: ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- **ุงูุงุฎุชุจุงุฑ**: ุฅุฏุฎุงู ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ

### **3. Redirect Issues**
- **ุงููุดููุฉ**: ุนุฏู ุงูุนูุฏุฉ ุฅูู checkout
- **ุงูุญู**: ุงูุชุญูู ูู `redirectTo` parameter
- **ุงูุงุฎุชุจุงุฑ**: ุงุฎุชุจุงุฑ ูู ุตูุญุงุช ูุฎุชููุฉ

### **4. Session Issues**
- **ุงููุดููุฉ**: ููุฏุงู ุงูุฌูุณุฉ ุฃุซูุงุก ุงูุชูุนูู
- **ุงูุญู**: ุงูุชุญูู ูู ุตุญุฉ ุงูุฌูุณุฉ
- **ุงูุงุฎุชุจุงุฑ**: ุฅุบูุงู ุงููุชุตูุญ ูุฅุนุงุฏุฉ ุงููุชุญ

---

## ๐ **ูุนุงููุฑ ุงููุฌุงุญ**

### **Functional Requirements**
- [ ] ุฅุฑุณุงู OTP ุนุจุฑ WhatsApp ุจูุฌุงุญ
- [ ] ุงูุชุญูู ูู OTP ุจูุฌุงุญ
- [ ] ุชุญุฏูุซ `user.isOtp = true`
- [ ] ุงูุนูุฏุฉ ุฅูู checkout
- [ ] ุนุฑุถ ุงูุญุงูุฉ ุงููุญุฏุซุฉ

### **Performance Requirements**
- [ ] ููุช ุงุณุชุฌุงุจุฉ ุฅุฑุณุงู OTP < 5 ุซูุงูู
- [ ] ููุช ุงุณุชุฌุงุจุฉ ุงูุชุญูู < 3 ุซูุงูู
- [ ] ููุช ุชุญููู ุตูุญุฉ checkout < 2 ุซุงููุฉ

### **UX Requirements**
- [ ] ุฑุณุงุฆู ูุงุถุญุฉ ููููููุฉ
- [ ] loading states ููุงุณุจุฉ
- [ ] error handling ุดุงูู
- [ ] smooth transitions

---

## ๐ฏ **ุฎุทูุงุช ุงูุชูููุฐ**

### **ุงููุฑุญูุฉ 1: ุฅุนุฏุงุฏ ุงูุจูุฆุฉ**
1. [ ] ุฅุถุงูุฉ environment variables
2. [ ] ุงุฎุชุจุงุฑ WhatsApp API connection
3. [ ] ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุจูุงูุงุช ููุงุฎุชุจุงุฑ

### **ุงููุฑุญูุฉ 2: ุงุฎุชุจุงุฑ ุงููุญุฏุงุช**
1. [ ] ุงุฎุชุจุงุฑ `otpViaWhatsApp` function
2. [ ] ุงุฎุชุจุงุฑ `verifyTheUser` function
3. [ ] ุงุฎุชุจุงุฑ `resendOTP` function

### **ุงููุฑุญูุฉ 3: ุงุฎุชุจุงุฑ ุงูุชูุงูู**
1. [ ] ุงุฎุชุจุงุฑ ุฑุญูุฉ ูุงููุฉ ูู checkout
2. [ ] ุงุฎุชุจุงุฑ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
3. [ ] ุงุฎุชุจุงุฑ rate limiting

### **ุงููุฑุญูุฉ 4: ุงุฎุชุจุงุฑ UX**
1. [ ] ุงุฎุชุจุงุฑ loading states
2. [ ] ุงุฎุชุจุงุฑ ุฑุณุงุฆู ุงููุฌุงุญ/ุงูุฎุทุฃ
3. [ ] ุงุฎุชุจุงุฑ responsive design

---

## ๐ **ุชูุฑูุฑ ุงูุงุฎุชุจุงุฑ**

### **Template**
```
ุชุงุฑูุฎ ุงูุงุฎุชุจุงุฑ: [DATE]
ุงููุฎุชุจุฑ: [NAME]
ุงูุจูุฆุฉ: [DEV/STAGING/PROD]

ุงููุชุงุฆุฌ:
โ ูุฌุญ: [LIST]
โ ูุดู: [LIST]
โ๏ธ ุชุญุณููุงุช: [LIST]

ุงูุชูุตูุงุช:
- [RECOMMENDATION 1]
- [RECOMMENDATION 2]
```

---

**ูู ุชุฑูุฏ ุฃู ูุจุฏุฃ ุจุชูููุฐ ูุฐู ุงูุฎุทุฉุ ุฃู ุชุญุชุงุฌ ุชุนุฏููุงุชุ** 